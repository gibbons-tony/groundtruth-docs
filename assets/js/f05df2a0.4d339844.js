"use strict";(globalThis.webpackChunkgroundtruth_docs=globalThis.webpackChunkgroundtruth_docs||[]).push([[433],{2099:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"trading-agent/introduction","title":"Profit Maximization Agent","description":"Commodity trading strategy backtesting and optimization framework.","source":"@site/docs/trading-agent/introduction.md","sourceDirName":"trading-agent","slug":"/trading-agent/introduction","permalink":"/groundtruth-docs/docs/trading-agent/introduction","draft":false,"unlisted":false,"editUrl":"https://github.com/gibbonstony/ucberkeley-capstone/tree/main/docs/trading-agent/introduction.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Research Agent","permalink":"/groundtruth-docs/docs/research-agent/introduction"},"next":{"title":"Complete Trading Strategy Implementation Guide","permalink":"/groundtruth-docs/docs/trading-agent/strategies"}}');var r=s(4848),t=s(8453);const a={sidebar_position:1},l="Profit Maximization Agent",c={},o=[{value:"System Architecture",id:"system-architecture",level:2},{value:"Three-Tier Design",id:"three-tier-design",level:3},{value:"Code Structure",id:"code-structure",level:2},{value:"Production System (9,105 lines)",id:"production-system-9105-lines",level:3},{value:"Configuration System",id:"configuration-system",level:2},{value:"Centralized Parameters (<code>config.py</code>)",id:"centralized-parameters-configpy",level:3},{value:"Strategy Parameters",id:"strategy-parameters",level:3},{value:"Parameter Management System",id:"parameter-management-system",level:3},{value:"Backtesting Engine",id:"backtesting-engine",level:2},{value:"Core Design (<code>backtest_engine.py</code>)",id:"core-design-backtest_enginepy",level:3},{value:"Trading Strategies",id:"trading-strategies",level:2},{value:"Design Pattern",id:"design-pattern",level:3},{value:"Baseline Strategies (4)",id:"baseline-strategies-4",level:3},{value:"Prediction-Based Strategies (5)",id:"prediction-based-strategies-5",level:3},{value:"Model Predictive Control (1)",id:"model-predictive-control-1",level:3},{value:"Execution Framework",id:"execution-framework",level:2},{value:"Runners System (<code>runners/</code>)",id:"runners-system-runners",level:3},{value:"Statistical Analysis",id:"statistical-analysis",level:2},{value:"Statistical Testing Framework (<code>analysis/statistical_tests.py:1,292 lines</code>)",id:"statistical-testing-framework-analysisstatistical_testspy1292-lines",level:3},{value:"Technology Stack",id:"technology-stack",level:2},{value:"Core Technologies",id:"core-technologies",level:3},{value:"Data Tables",id:"data-tables",level:3},{value:"Workflows",id:"workflows",level:2},{value:"Periodic Backtesting (Monthly)",id:"periodic-backtesting-monthly",level:3},{value:"Daily Operations",id:"daily-operations",level:3},{value:"Design Decisions",id:"design-decisions",level:2},{value:"Why Harvest-Based Inventory?",id:"why-harvest-based-inventory",level:3},{value:"Why 70% Accuracy Threshold?",id:"why-70-accuracy-threshold",level:3},{value:"Why 0.5% Storage Cost Per Day?",id:"why-05-storage-cost-per-day",level:3},{value:"Why 2,000 Monte Carlo Paths?",id:"why-2000-monte-carlo-paths",level:3},{value:"Performance Metrics",id:"performance-metrics",level:2},{value:"Line Counts (Verified)",id:"line-counts-verified",level:3},{value:"Execution Performance",id:"execution-performance",level:3},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"Planned Features",id:"planned-features",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"profit-maximization-agent",children:"Profit Maximization Agent"})}),"\n",(0,r.jsx)(n.p,{children:"Commodity trading strategy backtesting and optimization framework."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source Code"}),": ",(0,r.jsx)(n.code,{children:"trading_agent/production/"})," (9,105 lines across 3 subsystems)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["\ud83d\udcd6 ",(0,r.jsx)(n.a,{href:"./strategies",children:"Complete Strategy Implementation Guide \u2192"})]})," - Comprehensive technical reference with detailed explanations of all 10 strategies, technical indicators (RSI, ADX, CV), cost models, academic references, and implementation examples."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"system-architecture",children:"System Architecture"}),"\n",(0,r.jsx)(n.h3,{id:"three-tier-design",children:"Three-Tier Design"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1. BACKTESTING ENGINE (Core Logic)                          \u2502\n\u2502    - BacktestEngine: 400 lines                              \u2502\n\u2502    - Harvest cycle management                               \u2502\n\u2502    - Cost modeling (storage + transaction)                  \u2502\n\u2502    - Force liquidation logic                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 2. STRATEGY IMPLEMENTATIONS (Trading Logic)                 \u2502\n\u2502    - 10 strategies: 2,916 lines total                       \u2502\n\u2502    - Base class: Strategy (ABC)                             \u2502\n\u2502    - 4 baseline strategies: 340 lines                       \u2502\n\u2502    - 5 prediction-based: 1,190 lines                        \u2502\n\u2502    - 1 MPC optimization: 290 lines                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 3. EXECUTION FRAMEWORK (Orchestration)                      \u2502\n\u2502    - Runners: 2,172 lines                                   \u2502\n\u2502    - Data loading, strategy execution, results storage      \u2502\n\u2502    - Multi-commodity support                                \u2502\n\u2502    - Visualization (220+ charts)                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"code-structure",children:"Code Structure"}),"\n",(0,r.jsx)(n.h3,{id:"production-system-9105-lines",children:"Production System (9,105 lines)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"production/\n\u251c\u2500\u2500 core/                         400 lines\n\u2502   \u2514\u2500\u2500 backtest_engine.py        Harvest-aware backtesting\n\u2502\n\u251c\u2500\u2500 strategies/                 2,916 lines\n\u2502   \u251c\u2500\u2500 base.py                    76 lines - Abstract base class\n\u2502   \u251c\u2500\u2500 baseline.py               340 lines - 4 baseline strategies\n\u2502   \u251c\u2500\u2500 prediction.py           1,190 lines - 5 prediction strategies\n\u2502   \u251c\u2500\u2500 rolling_horizon_mpc.py    290 lines - MPC optimization\n\u2502   \u251c\u2500\u2500 indicators.py             174 lines - Technical indicators\n\u2502   \u251c\u2500\u2500 lp_optimizer.py           213 lines - Linear programming\n\u2502   \u2514\u2500\u2500 theoretical_max.py        269 lines - Perfect foresight benchmark\n\u2502\n\u251c\u2500\u2500 runners/                    2,172 lines\n\u2502   \u251c\u2500\u2500 data_loader.py            353 lines - Load prices + forecasts\n\u2502   \u251c\u2500\u2500 strategy_runner.py        391 lines - Execute single strategy\n\u2502   \u251c\u2500\u2500 multi_commodity_runner.py 526 lines - Orchestrate all combinations\n\u2502   \u251c\u2500\u2500 result_saver.py           346 lines - Save to Delta Lake\n\u2502   \u2514\u2500\u2500 visualization.py          510 lines - Generate 220+ charts\n\u2502\n\u251c\u2500\u2500 analysis/                   4,017 lines\n\u2502   \u251c\u2500\u2500 statistical_tests.py    1,292 lines - Paired t-tests, bootstrap CI\n\u2502   \u251c\u2500\u2500 strategy_analysis.py      379 lines - Efficiency ratios\n\u2502   \u2514\u2500\u2500 trade_level_stats.py      408 lines - Per-trade analysis\n\u2502\n\u251c\u2500\u2500 config.py                     277 lines - Central configuration\n\u251c\u2500\u2500 parameter_manager.py          700 lines - Parameter optimization\n\u2514\u2500\u2500 run_backtest_workflow.py      800 lines - Orchestration\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configuration-system",children:"Configuration System"}),"\n",(0,r.jsxs)(n.h3,{id:"centralized-parameters-configpy",children:["Centralized Parameters (",(0,r.jsx)(n.code,{children:"config.py"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Commodity Configuration"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"COMMODITY_CONFIGS = {\n    'coffee': {\n        'harvest_volume': 50,  # tons/year\n        'harvest_windows': [(5, 9)],  # May-September\n        'storage_cost_pct_per_day': 0.005,  # 0.5% per day\n        'transaction_cost_pct': 0.01,       # 1% per transaction\n        'max_holding_days': 365\n    },\n    'sugar': {\n        'harvest_volume': 50,\n        'harvest_windows': [(10, 12)],  # Oct-Dec\n        'storage_cost_pct_per_day': 0.005,\n        'transaction_cost_pct': 0.01,\n        'max_holding_days': 365\n    }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why These Parameters?"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"0.5% storage/day"}),": Based on diagnostic research (",(0,r.jsx)(n.code,{children:"CHANGELOG.md:2025-12-04"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"1% transaction"}),": Industry standard for commodity futures"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"365-day max"}),": Quality degradation after 1 year"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"strategy-parameters",children:"Strategy Parameters"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Baseline Strategies"})," (no predictions):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"BASELINE_PARAMS = {\n    'immediate_sale': {},  # Sell immediately, no params\n\n    'equal_batch': {\n        'batch_size': 0.25,      # 25% per batch\n        'frequency_days': 30      # Monthly sales\n    },\n\n    'price_threshold': {\n        'threshold_pct': 0.05     # Sell when price above MA + 5%\n    },\n\n    'moving_average': {\n        'ma_period': 30          # 30-day moving average\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prediction-Based Strategies"})," (use forecasts):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"PREDICTION_PARAMS = {\n    'consensus': {\n        'consensus_threshold': 0.70,  # 70% paths bullish to hold\n        'evaluation_day': 14          # Check 14-day forecast\n    },\n\n    'expected_value': {\n        'min_net_benefit_pct': 0.5   # 0.5% minimum gain to wait\n    },\n\n    'risk_adjusted': {\n        'min_return': 0.03,              # 3% minimum return\n        'max_uncertainty_low': 0.05,     # CV below 5% = low risk\n        'max_uncertainty_medium': 0.10,  # CV below 10% = med risk\n        'max_uncertainty_high': 0.20     # CV below 20% = high risk\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"parameter-management-system",children:"Parameter Management System"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Automatic Optimization Integration"})," (",(0,r.jsx)(n.code,{children:"parameter_manager.py"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class ParameterManager:\n    \"\"\"\n    Intelligent parameter management with automatic optimization fallback.\n\n    Design:\n        1. Try loading optimized parameters (from Optuna)\n        2. Fall back to defaults if not found\n        3. Log parameter source for transparency\n    \"\"\"\n\n    def get_params(self, source='auto'):\n        # source='optimized' \u2192 Use Optuna results only\n        # source='default'   \u2192 Use hardcoded defaults\n        # source='auto'      \u2192 Try optimized, fall back to default\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optimization Storage"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Path: ",(0,r.jsx)(n.code,{children:"/dbfs/production/files/optimized_params_{commodity}_{model}_v{version}.json"})]}),"\n",(0,r.jsx)(n.li,{children:"Format: JSON with all strategy parameters"}),"\n",(0,r.jsx)(n.li,{children:"Versioning: Multiple optimization runs tracked"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"backtesting-engine",children:"Backtesting Engine"}),"\n",(0,r.jsxs)(n.h3,{id:"core-design-backtest_enginepy",children:["Core Design (",(0,r.jsx)(n.code,{children:"backtest_engine.py"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Harvest-Based Inventory"})," (lines 12-116):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class BacktestEngine:\n    """\n    Key Innovation: Inventory starts at ZERO and accumulates during harvest.\n\n    Traditional approach: Start with full inventory\n    Our approach: Model realistic harvest accumulation\n    """\n\n    def _create_harvest_schedule(self):\n        """\n        Calculate daily inventory increments during harvest windows.\n\n        Example (Coffee):\n            - Harvest: May-September (153 days)\n            - Volume: 50 tons/year\n            - Daily increment: 50 / 153 = 0.327 tons/day\n        """\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Price Conversion"})," (line 18):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# CRITICAL: Futures prices in cents/lb, need $/ton\nprice_per_ton = price * 20  # 1 ton = 2000 lbs, cents\u2192dollars\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cost Modeling"})," (lines 200-230):"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Storage Costs"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Percentage-based (scales with commodity value)\ndaily_storage_cost = inventory * price_per_ton * storage_cost_pct_per_day\ntotal_storage += daily_storage_cost\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Transaction Costs"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Applied when selling\ntransaction_cost = sale_value * transaction_cost_pct\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Force Liquidation"})," (lines 56-76):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def _force_liquidation_check(self, day, inventory):\n    """\n    Two-tier liquidation to prevent quality loss:\n\n    1. Days 345-364: Gradual sell (5%/day)\n    2. Day 365: Force sell ALL remaining\n    """\n    days_since_harvest = day - harvest_start\n\n    if days_since_harvest >= 365:\n        return SELL_ALL  # Hard deadline\n    elif days_since_harvest >= 345:\n        return SELL(inventory * 0.05)  # Gradual liquidation\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"trading-strategies",children:"Trading Strategies"}),"\n",(0,r.jsx)(n.h3,{id:"design-pattern",children:"Design Pattern"}),"\n",(0,r.jsxs)(n.p,{children:["All strategies inherit from ",(0,r.jsx)(n.code,{children:"Strategy"})," base class:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class Strategy(ABC):\n    @abstractmethod\n    def decide(self, day, inventory, current_price, price_history, predictions=None):\n        \"\"\"\n        Args:\n            day: Current day index\n            inventory: Current inventory (tons)\n            current_price: Price (cents/lb)\n            price_history: DataFrame with date + price\n            predictions: numpy array (n_paths, 14_days) for forecast strategies\n\n        Returns:\n            dict: {'action': 'SELL'|'HOLD', 'amount': float, 'reason': str}\n        \"\"\"\n"})}),"\n",(0,r.jsx)(n.h3,{id:"baseline-strategies-4",children:"Baseline Strategies (4)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1. ImmediateSaleStrategy"})," (",(0,r.jsx)(n.code,{children:"baseline.py:29-70"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Sell all inventory immediately at regular intervals."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"min_batch_size"}),": 5.0 tons"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sale_frequency_days"}),": 7 days"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Logic"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"if days_since_last_sale >= 7 and inventory >= 5.0:\n    return SELL(inventory)  # Liquidate everything\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"2. EqualBatchStrategy"})," (",(0,r.jsx)(n.code,{children:"baseline.py:73-107"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Divide harvest into equal batches, sell on fixed schedule."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"batch_size"}),": 0.25 (25%)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"frequency_days"}),": 30"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Logic"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"if days_since_sale >= 30:\n    return SELL(inventory * 0.25)  # Sell quarter each month\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"3. PriceThresholdStrategy"})," (",(0,r.jsx)(n.code,{children:"baseline.py:110-218"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Sell when price exceeds 30-day moving average by threshold %."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"threshold_pct"}),": 0.05 (5%)"]}),"\n",(0,r.jsx)(n.li,{children:"Batch sizes modulated by RSI + ADX"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Technical Indicators"})," (",(0,r.jsx)(n.code,{children:"indicators.py"}),"):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RSI"})," (Relative Strength Index): Momentum oscillator"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ADX"})," (Average Directional Index): Trend strength"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Logic"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"ma_30 = price_history[-30:].mean()\nthreshold = ma_30 * (1 + 0.05)\n\nif current_price > threshold:\n    # Modulate batch size by indicators\n    if rsi > 70 and adx > 25:\n        return SELL(inventory * 0.35)  # Overbought + strong trend\n    elif rsi > 70:\n        return SELL(inventory * 0.30)  # Overbought\n    else:\n        return SELL(inventory * 0.25)  # Baseline\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"4. MovingAverageStrategy"})," (",(0,r.jsx)(n.code,{children:"baseline.py:220-340"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Sell on moving average crossover signals."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ma_period"}),": 30 days"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Logic"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"ma_current = price_history[-30:].mean()\nma_previous = price_history[-31:-1].mean()\n\n# Upward crossover\nif prev_price <= ma_previous and current_price > ma_current:\n    if rsi >= 40 and rsi <= 70 and adx > 25:\n        return SELL(inventory * 0.30)  # Strong signal\n"})}),"\n",(0,r.jsx)(n.h3,{id:"prediction-based-strategies-5",children:"Prediction-Based Strategies (5)"}),"\n",(0,r.jsxs)(n.p,{children:["All prediction strategies use ",(0,r.jsx)(n.strong,{children:"2,000 Monte Carlo forecast paths \xd7 14 days"})," from ",(0,r.jsx)(n.code,{children:"commodity.forecast.distributions"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"5. PriceThresholdPredictive"})," (",(0,r.jsx)(n.code,{children:"prediction.py:46-380"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Baseline PriceThreshold + forecast overlay with 3-tier confidence system."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Three-Tier Prediction Integration"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"cv = coefficient_of_variation(predictions)  # Forecast uncertainty\n\nif cv < 0.05:\n    # HIGH confidence (CV below 5%): OVERRIDE baseline\n    if strong_upward_signal:\n        return HOLD  # Wait for better price\n    elif strong_downward:\n        return SELL(inventory * 0.40)  # Aggressive sell\n\nelif cv < 0.15:\n    # MEDIUM confidence (CV below 15%): BLEND with baseline\n    baseline_decision = run_baseline_logic()\n    if upward_prediction:\n        reduce_sell_amount(baseline_decision * 0.6)\n    else:\n        return baseline_decision\n\nelse:\n    # LOW confidence (CV above 15%): FOLLOW baseline exactly\n    return run_price_threshold_baseline()\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"6. MovingAveragePredictive"})," (",(0,r.jsx)(n.code,{children:"prediction.py:387-732"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Baseline MovingAverage + forecast direction confirmation."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Logic"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"ma_signal = check_ma_crossover()\nforecast_direction = analyze_14day_trend(predictions)\n\nif ma_signal == BUY and forecast_direction == UPWARD:\n    return HOLD  # Both agree, wait\nelif ma_signal == SELL and forecast_direction == DOWNWARD:\n    return SELL(inventory * batch_size)  # Both agree, sell\nelse:\n    return HOLD  # Conflicting signals, wait\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"7. ExpectedValueStrategy"})," (",(0,r.jsx)(n.code,{children:"prediction.py:736-868"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Maximize expected return using forecast distribution."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Expected Value Calculation"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# For each of 14 forecast days\nexpected_values = []\nfor day in range(1, 15):\n    # Median of 2,000 paths\n    median_price = np.median(predictions[:, day-1])\n\n    # Subtract costs\n    storage_cost = (day * storage_cost_pct_per_day * median_price)\n    transaction_cost = transaction_cost_pct * median_price\n\n    net_value = median_price - storage_cost - transaction_cost\n    expected_values.append(net_value)\n\noptimal_day = argmax(expected_values)\nbest_ev = max(expected_values)\nsell_today_ev = current_price - transaction_cost\n\nif best_ev > sell_today_ev * (1 + min_net_benefit_pct):\n    return HOLD  # Waiting has positive expected value\nelse:\n    return SELL(inventory * batch_size)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"8. ConsensusStrategy"})," (",(0,r.jsx)(n.code,{children:"prediction.py:873-1029"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Democratic vote across 2,000 forecast paths."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Consensus Voting"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# At 14-day horizon\nfinal_prices = predictions[:, 13]  # All paths at day 14\ncurrent_price = price_history.iloc[-1]\n\n# Count bullish paths (above 3% return)\nbullish_paths = (final_prices > current_price * 1.03).sum()\nbullish_pct = bullish_paths / 2000\n\nif bullish_pct >= 0.85:\n    # Very strong consensus (85%+ bullish)\n    return HOLD\nelif bullish_pct >= 0.70:\n    # Strong consensus (70%+ bullish)\n    if cv < 0.05:\n        return HOLD  # High confidence, hold\n    else:\n        return SELL(inventory * 0.15)  # Gradual sell\nelif bullish_pct < 0.30:\n    # Bearish consensus (below 30% bullish)\n    return SELL(inventory * 0.35)  # Aggressive sell\nelse:\n    # Weak consensus (30-60%)\n    return SELL(inventory * 0.25)  # Default sell\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"9. RiskAdjustedStrategy"})," (",(0,r.jsx)(n.code,{children:"prediction.py:1035-1190"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Balance expected return vs forecast uncertainty (Sharpe ratio approach)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Risk-Adjusted Decision"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"expected_return = calculate_expected_value(predictions)\nuncertainty = std_dev(predictions) / mean(predictions)  # Coefficient of variation\n\n# Sharpe-like ratio\nrisk_adjusted_return = expected_return / (1 + uncertainty)\n\nif uncertainty < 0.05 and expected_return > 0.03:\n    # Low risk, decent return\n    return HOLD\nelif uncertainty > 0.20:\n    # High uncertainty, sell to reduce risk\n    return SELL(inventory * batch_size)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"model-predictive-control-1",children:"Model Predictive Control (1)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"10. RollingHorizonMPC"})," (",(0,r.jsx)(n.code,{children:"rolling_horizon_mpc.py:39-290"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Rolling horizon optimization using linear programming."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Linear Programming Formulation"}),":"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Decision Variables"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"x = [x_1, x_2, ..., x_14]  # Amount to sell each day\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Objective Function"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"maximize: \u03a3(price_t * x_t - storage_cost_t - transaction_cost_t)\n          for t in 1..14\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Constraints"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# 1. Non-negativity\nx_t >= 0  for all t\n\n# 2. Inventory conservation\n\u03a3(x_t) <= current_inventory\n\n# 3. Daily bounds\nx_t <= inventory * 0.40  # Max 40% per day\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Implementation"})," (using scipy.optimize.linprog):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from scipy.optimize import linprog\n\n# Coefficients (negative for minimization)\nc = [-price_1, -price_2, ..., -price_14] + storage_costs + transaction_costs\n\n# Inequality constraints (A_ub @ x <= b_ub)\nA_ub = [[1, 1, ..., 1]]  # Sum constraint\nb_ub = [inventory]\n\n# Bounds\nbounds = [(0, inventory*0.40) for _ in range(14)]\n\nresult = linprog(c, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method='highs')\n\n# Execute first day's decision\nreturn SELL(result.x[0])\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"execution-framework",children:"Execution Framework"}),"\n",(0,r.jsxs)(n.h3,{id:"runners-system-runners",children:["Runners System (",(0,r.jsx)(n.code,{children:"runners/"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Data Flow"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"data_loader.py\n    \u2193 (prices + forecasts)\nstrategy_runner.py\n    \u2193 (backtest results)\nmulti_commodity_runner.py\n    \u2193 (aggregate results)\nresult_saver.py \u2192 Delta Lake\n    \u2193\nvisualization.py \u2192 220+ charts\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1. DataLoader"})," (",(0,r.jsx)(n.code,{children:"data_loader.py:353 lines"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class DataLoader:\n    def load_price_data(commodity, start_date=None):\n        """\n        Load from commodity.silver.unified_data\n        Returns: DataFrame with date + price\n        """\n\n    def load_forecast_distributions(commodity, model_version):\n        """\n        Load from commodity.forecast.distributions\n        Returns: Dict mapping date \u2192 numpy array (2000 paths \xd7 14 days)\n        """\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"2. StrategyRunner"})," (",(0,r.jsx)(n.code,{children:"strategy_runner.py:391 lines"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class StrategyRunner:\n    def run_backtest(strategy, prices, predictions, config):\n        """\n        Execute single strategy across all historical dates.\n\n        Returns:\n            - Daily state DataFrame\n            - Trade log\n            - Performance metrics (earnings, Sharpe, trades)\n        """\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"3. MultiCommodityRunner"})," (",(0,r.jsx)(n.code,{children:"multi_commodity_runner.py:526 lines"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Orchestrates all combinations:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"2 commodities (Coffee, Sugar)"}),"\n",(0,r.jsx)(n.li,{children:"10+ models per commodity"}),"\n",(0,r.jsx)(n.li,{children:"10 strategies"}),"\n",(0,r.jsx)(n.li,{children:"= 200+ backtest runs"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"4. ResultSaver"})," (",(0,r.jsx)(n.code,{children:"result_saver.py:346 lines"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Saves to Delta Lake:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Summary table\ncommodity.trading_agent.results_{commodity}_{model}\n    - strategy, net_earnings, sharpe_ratio, n_trades, ...\n\n# Detailed results (pickle files)\n/Volumes/commodity/trading_agent/files/results_detailed_*.pkl\n    - Daily state\n    - Trade-by-trade log\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"5. Visualization"})," (",(0,r.jsx)(n.code,{children:"visualization.py:510 lines"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Generates 220+ charts:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cumulative earnings by strategy"}),"\n",(0,r.jsx)(n.li,{children:"Inventory timeline"}),"\n",(0,r.jsx)(n.li,{children:"Price vs sale timing"}),"\n",(0,r.jsx)(n.li,{children:"Strategy heatmaps"}),"\n",(0,r.jsx)(n.li,{children:"Performance comparisons"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"statistical-analysis",children:"Statistical Analysis"}),"\n",(0,r.jsxs)(n.h3,{id:"statistical-testing-framework-analysisstatistical_testspy1292-lines",children:["Statistical Testing Framework (",(0,r.jsx)(n.code,{children:"analysis/statistical_tests.py:1,292 lines"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Primary Comparison"}),": Prediction strategies vs Immediate Sale baseline"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tests Applied"}),":"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1. Paired t-test"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Compare SAME years for both strategies\nyears = [2020, 2021, 2022, 2023, 2024]\nstrategy_earnings = [125k, 130k, 128k, 135k, 132k]\nbaseline_earnings = [98k, 102k, 100k, 105k, 103k]\n\nt_stat, p_value = ttest_rel(strategy_earnings, baseline_earnings)\n\n# Significant if p < 0.05\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"2. Effect Size (Cohen's d)"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"mean_diff = mean(strategy) - mean(baseline)\npooled_std = sqrt((std(strategy)\xb2 + std(baseline)\xb2) / 2)\ncohens_d = mean_diff / pooled_std\n\n# Interpretation:\n# Small: |d| = 0.2\n# Medium: |d| = 0.5\n# Large: |d| = 0.8+\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"3. Bootstrap Confidence Intervals"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# 10,000 resamples\nbootstrap_diffs = []\nfor _ in range(10000):\n    sample = resample(year_differences)\n    bootstrap_diffs.append(mean(sample))\n\nci_95 = percentile(bootstrap_diffs, [2.5, 97.5])\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"4. Sign Test"})," (non-parametric):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# How many years did strategy beat baseline?\nwins = sum(strategy > baseline)\np_value = binomial_test(wins, n_years, p=0.5)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Output Example"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Rolling Horizon MPC vs Immediate Sale\n\nSample Size: 5 years (2020-2024)\n\nPaired t-test:\n  t-statistic: 4.23\n  p-value: 0.014 \u2713 SIGNIFICANT\n\nEffect Size:\n  Cohen's d: 3.22 (Very large)\n\n95% CI: [$11,450, $42,990]\n  \u2713 Does not include zero\n\nSign Test:\n  Years positive: 5/5\n  p-value: 0.031 \u2713 SIGNIFICANT\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"technology-stack",children:"Technology Stack"}),"\n",(0,r.jsx)(n.h3,{id:"core-technologies",children:"Core Technologies"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"Technology"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Compute"})}),(0,r.jsx)(n.td,{children:"Databricks (PySpark)"}),(0,r.jsx)(n.td,{children:"Distributed backtesting"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Storage"})}),(0,r.jsx)(n.td,{children:"Delta Lake"}),(0,r.jsx)(n.td,{children:"Results storage"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Catalog"})}),(0,r.jsx)(n.td,{children:"Unity Catalog"}),(0,r.jsx)(n.td,{children:"Data governance"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Optimization"})}),(0,r.jsx)(n.td,{children:"scipy.optimize"}),(0,r.jsx)(n.td,{children:"Linear programming (MPC)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Statistics"})}),(0,r.jsx)(n.td,{children:"NumPy, Pandas, SciPy"}),(0,r.jsx)(n.td,{children:"Analysis, metrics"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Orchestration"})}),(0,r.jsx)(n.td,{children:"Python subprocess"}),(0,r.jsx)(n.td,{children:"Workflow management"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"data-tables",children:"Data Tables"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Input Tables"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"commodity.silver.unified_data           # Historical prices\ncommodity.forecast.distributions        # Monte Carlo forecasts (2K paths)\ncommodity.bronze.fx_rates               # Exchange rates (15+ currencies)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Output Tables"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"commodity.trading_agent.results_{commodity}_{model}\ncommodity.trading_agent.results_{commodity}_by_year_{model}\ncommodity.trading_agent.statistical_tests_{commodity}_{model}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"workflows",children:"Workflows"}),"\n",(0,r.jsx)(n.h3,{id:"periodic-backtesting-monthly",children:"Periodic Backtesting (Monthly)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Evaluate strategy performance, identify best approaches"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Orchestrator"}),": ",(0,r.jsx)(n.code,{children:"run_backtest_workflow.py"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Steps"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Load latest forecasts from ",(0,r.jsx)(n.code,{children:"commodity.forecast.distributions"})]}),"\n",(0,r.jsx)(n.li,{children:"Run backtests: 10 strategies \xd7 10+ models \xd7 2 commodities"}),"\n",(0,r.jsx)(n.li,{children:"Calculate metrics (earnings, Sharpe, trades)"}),"\n",(0,r.jsx)(n.li,{children:"Run statistical tests"}),"\n",(0,r.jsx)(n.li,{children:"Identify best strategy per commodity-model"}),"\n",(0,r.jsx)(n.li,{children:"Save results to Delta Lake"}),"\n",(0,r.jsx)(n.li,{children:"Generate 220+ visualization charts"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Duration"}),": 30-45 minutes for all commodities"]}),"\n",(0,r.jsx)(n.h3,{id:"daily-operations",children:"Daily Operations"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Generate trading recommendations"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Script"}),": ",(0,r.jsx)(n.code,{children:"operations/daily_recommendations.py"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Steps"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Load today's forecast for specified model"}),"\n",(0,r.jsx)(n.li,{children:"Load current state (inventory, price history)"}),"\n",(0,r.jsx)(n.li,{children:"Apply active strategy"}),"\n",(0,r.jsx)(n.li,{children:"Generate SELL/HOLD recommendation"}),"\n",(0,r.jsx)(n.li,{children:"Output JSON for WhatsApp integration"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Duration"}),": Less than 1 minute"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"design-decisions",children:"Design Decisions"}),"\n",(0,r.jsx)(n.h3,{id:"why-harvest-based-inventory",children:"Why Harvest-Based Inventory?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Traditional"}),": Start with full inventory at year start\n",(0,r.jsx)(n.strong,{children:"Our approach"}),": Inventory accumulates during harvest windows"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rationale"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"More realistic for agricultural producers"}),"\n",(0,r.jsx)(n.li,{children:"Models actual harvest timing"}),"\n",(0,r.jsx)(n.li,{children:"Prevents unrealistic pre-harvest sales"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"why-70-accuracy-threshold",children:"Why 70% Accuracy Threshold?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Research"}),": Synthetic model testing at 60%, 70%, 80%, 90%, 100% accuracy"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Finding"}),": Below 70% directional accuracy, prediction-based strategies DO NOT beat baselines"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source"}),": ",(0,r.jsx)(n.code,{children:"archive/notebooks/diagnostics/SYNTHETIC_PREDICTION_TEST_PLAN.md"})]}),"\n",(0,r.jsx)(n.h3,{id:"why-05-storage-cost-per-day",children:"Why 0.5% Storage Cost Per Day?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Research"}),": Diagnostic parameter sensitivity analysis"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source"}),": ",(0,r.jsx)(n.code,{children:"CHANGELOG.md:2025-12-04"}),' - "Critical parameter alignment fixes applied"']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Calculation"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"0.5% per day \xd7 365 days = 182.5% annual storage cost"}),"\n",(0,r.jsx)(n.li,{children:"Reflects warehouse fees, insurance, quality degradation"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"why-2000-monte-carlo-paths",children:"Why 2,000 Monte Carlo Paths?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tradeoff"}),": Accuracy vs compute cost"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"100 paths: Too noisy"}),"\n",(0,r.jsx)(n.li,{children:"1,000 paths: Good but still variance"}),"\n",(0,r.jsx)(n.li,{children:"2,000 paths: Stable percentile estimates"}),"\n",(0,r.jsx)(n.li,{children:"10,000 paths: Diminishing returns"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source"}),": ",(0,r.jsx)(n.code,{children:"forecast_agent/docs/DESIGN_DECISIONS.md"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"performance-metrics",children:"Performance Metrics"}),"\n",(0,r.jsx)(n.h3,{id:"line-counts-verified",children:"Line Counts (Verified)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Production System"}),": 9,105 lines"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Core: 400 lines"}),"\n",(0,r.jsx)(n.li,{children:"Strategies: 2,916 lines"}),"\n",(0,r.jsx)(n.li,{children:"Runners: 2,172 lines"}),"\n",(0,r.jsx)(n.li,{children:"Analysis: 4,017 lines"}),"\n",(0,r.jsx)(n.li,{children:"Config: 277 lines"}),"\n",(0,r.jsx)(n.li,{children:"Orchestration: 800 lines"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"execution-performance",children:"Execution Performance"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Backtest Speed"}),": 30-45 minutes for full analysis"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"2 commodities"}),"\n",(0,r.jsx)(n.li,{children:"10+ models each"}),"\n",(0,r.jsx)(n.li,{children:"10 strategies"}),"\n",(0,r.jsx)(n.li,{children:"200+ total combinations"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Statistical Tests"}),": 5-10 minutes"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Paired t-tests"}),"\n",(0,r.jsx)(n.li,{children:"Bootstrap CI (10,000 iterations)"}),"\n",(0,r.jsx)(n.li,{children:"Effect sizes"}),"\n",(0,r.jsx)(n.li,{children:"Sign tests"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,r.jsx)(n.h3,{id:"planned-features",children:"Planned Features"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Strategy Selection Automation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Store best strategy per commodity-model in config table"}),"\n",(0,r.jsx)(n.li,{children:"Daily operations auto-select active strategy"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Performance Tracking"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Log recommendations vs actual outcomes"}),"\n",(0,r.jsx)(n.li,{children:"Calculate recommendation accuracy over time"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Multi-Objective Optimization"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Optimize for earnings AND Sharpe ratio"}),"\n",(0,r.jsx)(n.li,{children:"Pareto frontier analysis"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Real-Time Monitoring"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Dashboard for live strategy performance"}),"\n",(0,r.jsx)(n.li,{children:"Alert system for anomalies"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"System Overview"}),": ",(0,r.jsx)(n.code,{children:"MASTER_SYSTEM_PLAN.md"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Statistical Testing"}),": ",(0,r.jsx)(n.code,{children:"STATISTICAL_TESTING_REVIEW.md"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configuration"}),": ",(0,r.jsx)(n.code,{children:"production/README.md"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Changelog"}),": ",(0,r.jsx)(n.code,{children:"production/CHANGELOG.md"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Last Updated"}),": 2025-12-10\n",(0,r.jsx)(n.strong,{children:"Source Code"}),": ",(0,r.jsx)(n.a,{href:"https://github.com/gibbonstony/ucberkeley-capstone/tree/main/trading_agent",children:"GitHub"})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);